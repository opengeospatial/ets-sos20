<ctl:package xmlns:ctl="http://www.occamlab.com/ctl" xmlns:fes="http://www.opengis.net/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:om="http://www.opengis.net/om/2.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:owsTests="http://www.opengis.net/ows/1.1" xmlns:parsers="http://www.occamlab.com/te/parsers" xmlns:sml="http://www.opengis.net/sensorML/1.0.1" xmlns:soap11="http://schemas.xmlsoap.org/soap/" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope" xmlns:sos="http://www.opengis.net/sos/2.0" xmlns:sosFunctions="http://www.opengis.net/sos/2.0" xmlns:swe="http://www.opengis.net/swe/2.0" xmlns:swes="http://www.opengis.net/swes/2.0" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<!-- 08.SOS Transactional: InsertSensor -->
   <ctl:test name="sos:InsertSensor-Test" isConformanceClass="true">
      <ctl:param name="serviceURL" />
      <ctl:param name="hasIS" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="serviceType" />
      <ctl:param name="serviceVersion" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="InsertSensorResponseContentType" />
      <ctl:param name="exceptionReportSchemaLocation" />
      <ctl:param name="exceptionReportSchemaType" />
      <ctl:param name="test0801" />
      <ctl:param name="test0802" />
      <ctl:param name="test0803" />
      <ctl:param name="test0804" />
      <ctl:param name="test0805" />
      <ctl:param name="test0806" />
      <ctl:param name="test0807" />
      <ctl:param name="test0808" />
      <ctl:param name="test0809" />
      <ctl:param name="test0810" />
      <ctl:param name="test0811" />
      <ctl:param name="test0812" />
      <ctl:param name="test0813" />
      <ctl:assertion>Execute InsertSensor Test.</ctl:assertion>
      <ctl:comment>Pass if all the subtest not fail; fail otherwise.</ctl:comment>
      <ctl:code>
         <xsl:choose>
            <xsl:when test="$hasIS eq 'false'">
               <ctl:message>The server does not support the operation "InsertSensor", so skip this test.</ctl:message>
            </xsl:when>
            <xsl:otherwise>
               <!-- 從GetCapabilities取得有效的 offering,procedure,observedProperty -->
               <!-- get a valid procedureDescriptionFormat-->
               <xsl:variable name="procedureDescriptionFormat" select="$getCapabilitiesResponse//ows:Operation[@name='InsertSensor']/ows:Parameter[@name='procedureDescriptionFormat']//ows:Value" />
               <!-- get a valid observableProperty-->
               <xsl:variable name="observableProperty" select="$getCapabilitiesResponse//sos:contents//swes:offering[1]//swes:observableProperty[1]" />
               <!-- get a valid observationType-->
               <xsl:variable name="observationType" select="$getCapabilitiesResponse//sos:extension/sos:InsertionCapabilities/sos:observationType[1]" />
               <!-- get a valid featureOfInterestType-->
               <xsl:variable name="featureOfInterestType" select="$getCapabilitiesResponse//sos:extension/sos:InsertionCapabilities/sos:featureOfInterestType[1]" />
               <xsl:if test="$test0801 eq 'true'">
                  <ctl:message select="'******************** 08.01.RequestNoService ********************'" />
                  <ctl:call-test name="sos:ISRequestNoService_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0802 eq 'true'">
                  <ctl:message select="'******************** 08.02.RequestNullService ********************'" />
                  <ctl:call-test name="sos:ISRequestNullService_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0803 eq 'true'">
                  <ctl:message select="'******************** 08.03.RequestInvalidService ********************'" />
                  <ctl:call-test name="sos:ISRequestInvalidService_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0804 eq 'true'">
                  <ctl:message select="'******************** 08.04.RequestNoVersion ********************'" />
                  <ctl:call-test name="sos:ISRequestNoVersion_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0805 eq 'true'">
                  <ctl:message select="'******************** 08.05.RequestNullVersion ********************'" />
                  <ctl:call-test name="sos:ISRequestNullVersion_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0806 eq 'true'">
                  <ctl:message select="'******************** 08.06.RequestInvalidVersion ********************'" />
                  <ctl:call-test name="sos:ISRequestInvalidVersion_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0807 eq 'true'">
                  <ctl:message select="'******************** 08.07.RequestNullprocedureDescriptionFormat ********************'" />
                  <ctl:call-test name="sos:ISRequestNullprocedureDescriptionFormat_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0808 eq 'true'">
                  <ctl:message select="'******************** 08.08.RequestInvalidprocedureDescriptionFormat ********************'" />
                  <ctl:call-test name="sos:ISRequestInvalidprocedureDescriptionFormat_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0809 eq 'true'">
                  <ctl:message select="'******************** 08.09.RequestNullfeatureOfInterestType ********************'" />
                  <ctl:call-test name="sos:ISRequestNullfeatureOfInterestType_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0810 eq 'true'">
                  <ctl:message select="'******************** 08.10.RequestInvalidfeatureOfInterestType ********************'" />
                  <ctl:call-test name="sos:ISRequestInvalidfeatureOfInterestType_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0811 eq 'true'">
                  <ctl:message select="'******************** 08.11.RequestNullobservationType ********************'" />
                  <ctl:call-test name="sos:ISRequestNullobservationType_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0812 eq 'true'">
                  <ctl:message select="'******************** 08.12.RequestInvalidobservationType ********************'" />
                  <ctl:call-test name="sos:ISRequestInvalidobservationType_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
               <xsl:if test="$test0813 eq 'true'">
                  <ctl:message select="'******************** 08.13.RequestValidRequest ********************'" />
                  <ctl:call-test name="sos:ISRequestValidRequest_sensorInsertion">
                     <ctl:with-param name="serviceURL" select="$serviceURL" />
                     <ctl:with-param name="isSOAP" select="$isSOAP" />
                     <ctl:with-param name="getCapabilitiesResponse" select="$getCapabilitiesResponse" />
                     <ctl:with-param name="InsertSensorRootElementName" select="$InsertSensorRootElementName" />
                     <ctl:with-param name="InsertSensorResponseSchemaLocation" select="$InsertSensorResponseSchemaLocation" />
                     <ctl:with-param name="InsertSensorResponseSchemaType" select="$InsertSensorResponseSchemaType" />
                     <ctl:with-param name="procedureDescriptionFormat" select="$procedureDescriptionFormat" />
                     <ctl:with-param name="observableProperty" select="$observableProperty" />
                     <ctl:with-param name="observationType" select="$observationType" />
                     <ctl:with-param name="featureOfInterestType" select="$featureOfInterestType" />
                  </ctl:call-test>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0801 Send InsertSensor request without parameter service (KVP) ,the response must be a valid exception with code "MissingParameterValue" and locator "service".. -->
   <!-- 0801 Send InsertSensor request without parameter service (POST or SOAP) ,the response must be a valid exception with code "InvalidRequest" and locator "Expected attribute: service in element InsertSensor@http://www.opengis.net/swes/2.0".. -->
   <ctl:test name="sos:ISRequestNoService_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request (KVP) without parameter "service",and the response must be a valid exception with code "MissingParameterValue" and locator "service". 
			Send a request (POST or SOAP) without parameter "service",and the response must be a valid exception with code "InvalidRequest" and locator "Expected attribute: service in element InsertSensor@http://www.opengis.net/swes/2.0".</ctl:assertion>
      <ctl:comment>Pass if the server (KVP) returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "service"; fail otherwise.
			Pass if the server (POST or SOAP) returns a valid exception message with an exceptionCode "InvalidRequest" and locator is "Expected attribute: service in element InsertSensor@http://www.opengis.net/swes/2.0"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with no service parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidRequest')" />
                        <ctl:with-param name="locatorToCheck" select="string('Expected attribute: service in element InsertSensor@http://www.opengis.net/swes/2.0')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with no service parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidRequest" and a locator of "Expected attribute: service in element InsertSensor@http://www.opengis.net/swes/2.0".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0802 Send InsertSensor request with null parameter service ,the response must be a valid exception with code "MissingParameterValue" and locator "service".. -->
   <ctl:test name="sos:ISRequestNullService_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with null parameter "service",and the response must be a valid exception with code "MissingParameterValue" and locator "service".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "service"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid service parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('MissingParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('service')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with null service parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "MissingParameterValue" and a locator of "service".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0803 Send InsertSensor request with invalid parameter service ,the response must be a valid exception with code "InvalidParameterValue" and locator "service".. -->
   <ctl:test name="sos:ISRequestInvalidService_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with invalid parameter "procedure",and the response must be a valid exception with code "InvalidParameterValue" and locator "service".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "InvalidParameterValue" and locator is "service"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="ASDF" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="ASDF" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid service parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('service')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with invalid service parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidParameterValue" and a locator of "service".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0804 Send InsertSensor request without parameter version (KVP) ,the response must be a valid exception with code "MissingParameterValue" and locator "version".. -->
   <!-- 0804 Send InsertSensor request without parameter version ,the response must be a valid exception with code "InvalidRequest" and locator "Expected attribute: version in element InsertSensor@http://www.opengis.net/swes/2.0".. -->
   <ctl:test name="sos:ISRequestNoVersion_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request (KVP) without parameter "version",and the response must be a valid exception with code "MissingParameterValue" and locator "version". 
			Send a request (POST or SOAP) without parameter "version",and the response must be a valid exception with code "InvalidRequest" and locator "Expected attribute: service in element InsertSensor@http://www.opengis.net/swes/2.0".</ctl:assertion>
      <ctl:comment>Pass if the server (KVP) returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "version"; fail otherwise.
			Pass if the server (POST or SOAP) returns a valid exception message with an exceptionCode "InvalidRequest" and locator is "Expected attribute: version in element InsertSensor@http://www.opengis.net/swes/2.0"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with no version parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidRequest')" />
                        <ctl:with-param name="locatorToCheck" select="string('Expected attribute: version in element InsertSensor@http://www.opengis.net/swes/2.0')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with no version parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidRequest" and a locator of "Expected attribute: version in element InsertSensor@http://www.opengis.net/swes/2.0".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0805 Send InsertSensor request with null parameter version ,the response must be a valid exception with code "MissingParameterValue" and locator "version".. -->
   <ctl:test name="sos:ISRequestNullVersion_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with null parameter "version",and the response must be a valid exception with code "MissingParameterValue" and locator "version".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "version"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid version parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('MissingParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('version')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with null version parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "MissingParameterValue" and a locator of "version".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0806 Send InsertSensor request with invalid parameter version ,the response must be a valid exception with code "InvalidParameterValue" and locator "version".. -->
   <ctl:test name="sos:ISRequestInvalidVersion_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with invalid parameter "version",and the response must be a valid exception with code "InvalidParameterValue" and locator "version".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "InvalidParameterValue" and locator is "version"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="999" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="999" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid version parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('version')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with invalid version parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidParameterValue" and a locator of "version".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0807 Send InsertSensor request with null Element procedureDescriptionFormat ,the response must be a valid exception with code "MissingParameterValue" and locator "procedureDescriptionFormat".. -->
   <ctl:test name="sos:ISRequestNullprocedureDescriptionFormat_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with null parameter "procedureDescriptionFormat",and the response must be a valid exception with code "MissingParameterValue" and locator "procedureDescriptionFormat".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "procedureDescriptionFormat"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat />
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="999" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat />
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid procedureDescriptionFormat parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('MissingParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('procedureDescriptionFormat')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with null procedureDescriptionFormat parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "MissingParameterValue" and a locator of "procedureDescriptionFormat".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0808 Send InsertSensor request with invalid Element procedureDescriptionFormat ,the response must be a valid exception with code "InvalidParameterValue" and locator "procedureDescriptionFormat".. -->
   <ctl:test name="sos:ISRequestInvalidprocedureDescriptionFormat_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with invalid parameter "procedureDescriptionFormat",and the response must be a valid exception with code "InvalidParameterValue" and locator "procedureDescriptionFormat".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "InvalidParameterValue" and locator is "procedureDescriptionFormat"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="current-dateTime()" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="999" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="current-dateTime()" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid procedureDescriptionFormat parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('procedureDescriptionFormat')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with invalid procedureDescriptionFormat parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidParameterValue" and a locator of "procedureDescriptionFormat".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0809 Send InsertSensor request with null Element featureOfInterestType ,the response must be a valid exception with code "MissingParameterValue" and locator "featureOfInterestType".. -->
   <ctl:test name="sos:ISRequestNullfeatureOfInterestType_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with null parameter "procedureDescriptionFormat",and the response must be a valid exception with code "MissingParameterValue" and locator "procedureDescriptionFormat".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "procedureDescriptionFormat"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType />
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType />
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid featureOfInterestType parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('MissingParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('featureOfInterestType')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with null featureOfInterestType parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "MissingParameterValue" and a locator of "featureOfInterestType".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0810 Send InsertSensor request with invalid Element featureOfInterestType ,the response must be a valid exception with code "InvalidParameterValue" and locator "featureOfInterestType".. -->
   <ctl:test name="sos:ISRequestInvalidfeatureOfInterestType_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with invalid parameter "procedureDescriptionFormat",and the response must be a valid exception with code "InvalidParameterValue" and locator "procedureDescriptionFormat".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "InvalidParameterValue" and locator is "procedureDescriptionFormat"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="current-dateTime()" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="current-dateTime()" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid featureOfInterestType parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('featureOfInterestType')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with invalid featureOfInterestType parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidParameterValue" and a locator of "featureOfInterestType".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0811 Send InsertSensor request with null Element observationType ,the response must be a valid exception with code "MissingParameterValue" and locator "observationType".. -->
   <ctl:test name="sos:ISRequestNullobservationType_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with null parameter "procedureDescriptionFormat",and the response must be a valid exception with code "MissingParameterValue" and locator "procedureDescriptionFormat".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "MissingParameterValue" and locator is "procedureDescriptionFormat"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <!-- send request -->
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType />
                                 <sos:featureOfInterestType />
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType />
                                 <sos:featureOfInterestType />
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid observationType parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('MissingParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('observationType')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with null observationType parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "MissingParameterValue" and a locator of "observationType".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0812 Send InsertSensor request with invalid Element observationType ,the response must be a valid exception with code "InvalidParameterValue" and locator "observationType".. -->
   <ctl:test name="sos:ISRequestInvalidobservationType_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a request with invalid parameter "observationType",and the response must be a valid exception with code "InvalidParameterValue" and locator "observationType".</ctl:assertion>
      <ctl:comment>Pass if the server returns a valid exception message with an exceptionCode "InvalidParameterValue" and locator is "observationType"; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="current-dateTime()" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReportSOAP" />
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="current-dateTime()" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <ctl:call-function name="sosFunctions:validateExceptionReport" />
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <xsl:if test="$InsertSensorResponse/*">
                  <xsl:if test="$isSOAP=string('true')">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfoSOAP($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <xsl:if test="not($isSOAP=string('true'))">
                     <ctl:message>
                        The response was:
                        <xsl:value-of select="sosFunctions:getExceptionInfo($InsertSensorResponse)" />
                     </ctl:message>
                  </xsl:if>
                  <ctl:message>Checking the validity of the response to a InsertSensor request with invalid observationType parameter.</ctl:message>
                  <xsl:variable name="isCorrect">
                     <ctl:call-function name="sosFunctions:checkExceptionReport">
                        <ctl:with-param name="exceptionReport" select="$InsertSensorResponse" />
                        <ctl:with-param name="exceptionCodeToCheck" select="string('InvalidParameterValue')" />
                        <ctl:with-param name="locatorToCheck" select="string('observationType')" />
                        <ctl:with-param name="PostEncodingIsSOAP" select="$isSOAP" />
                     </ctl:call-function>
                  </xsl:variable>
                  <ctl:message>
                     The validity check returned:
                     <xsl:value-of select="$isCorrect" />
                  </ctl:message>
                  <xsl:if test="not(xsd:boolean($isCorrect))">
                     <ctl:message>FAILURE:  The server did not return the expected exception report response to a InsertSensor request with invalid observationType parameter specified.</ctl:message>
                     <ctl:message>The response was expected to be an ExceptionReport with an exceptionCode of "InvalidParameterValue" and a locator of "observationType".</ctl:message>
                     <ctl:fail />
                  </xsl:if>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
   <!-- 0813 Send valid InsertSensor request, the response must be a valid InsertSensorResponse. -->
   <ctl:test name="sos:ISRequestValidRequest_sensorInsertion">
      <ctl:param name="serviceURL" />
      <ctl:param name="isSOAP" />
      <ctl:param name="getCapabilitiesResponse" />
      <ctl:param name="InsertSensorRootElementName" />
      <ctl:param name="InsertSensorResponseSchemaLocation" />
      <ctl:param name="InsertSensorResponseSchemaType" />
      <ctl:param name="procedureDescriptionFormat" />
      <ctl:param name="observableProperty" />
      <ctl:param name="observationType" />
      <ctl:param name="featureOfInterestType" />
      <ctl:assertion>Send a valid request ,and there must be have a valid InsertSensorResponse returned.</ctl:assertion>
      <ctl:comment>Pass if the root of the response is "InsertSensorResponse" and there is one assignedProcedure element and one assignedOffering element in the InsertSensorResponse; fail otherwise.</ctl:comment>
      <ctl:link title="" />
      <ctl:code>
         <xsl:variable name="InsertSensorResponse">
            <xsl:choose>
               <xsl:when test="$isSOAP eq 'true'">
                  <ctl:soap-request version="1.2" charset="UTF-8">
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <parsers:SOAPParser return="content">
                        <parsers:XMLValidatingParser>
                           <parsers:schemas>
                              <parsers:schema>
                                 <xsl:attribute name="type">
                                    <xsl:value-of select="$InsertSensorResponseSchemaType" />
                                 </xsl:attribute>
                                 <xsl:value-of select="$InsertSensorResponseSchemaLocation" />
                              </parsers:schema>
                           </parsers:schemas>
                        </parsers:XMLValidatingParser>
                     </parsers:SOAPParser>
                  </ctl:soap-request>
               </xsl:when>
               <xsl:otherwise>
                  <ctl:request>
                     <ctl:url>
                        <xsl:value-of select="$serviceURL" />
                     </ctl:url>
                     <ctl:method>post</ctl:method>
                     <ctl:body>
                        <swes:InsertSensor xmlns:gml="http://www.opengis.net/gml" xmlns:swe="http://www.opengis.net/swe/1.0.1" service="SOS" version="2.0.0" xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope/soap-envelope.xsd            http://www.opengis.net/sos/2.0 http://schemas.opengis.net/sos/2.0/sos.xsd">
                           <swes:procedureDescriptionFormat>
                              <xsl:value-of select="$procedureDescriptionFormat" />
                           </swes:procedureDescriptionFormat>
                           <swes:procedureDescription>
                              <sml:SensorML version="1.0.1">
                                 <sml:member>
                                    <sml:System>
                                       <sml:identification>
                                          <sml:IdentifierList>
                                             <sml:identifier name="uniqueID">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:identification xlink:title="offerings">
                                          <sml:IdentifierList>
                                             <sml:identifier name="Offering for sensor 9876">
                                                <sml:Term definition="urn:ogc:def:identifier:OGC:offeringID">
                                                   <sml:value>
                                                      http://www.example.org/sensors/
                                                      <xsl:value-of select="current-dateTime()" />
                                                      /observations
                                                   </sml:value>
                                                </sml:Term>
                                             </sml:identifier>
                                          </sml:IdentifierList>
                                       </sml:identification>
                                       <sml:capabilities name="parentProcedures">
                                          <swe:SimpleDataRecord>
                                             <gml:metaDataProperty xlink:title="http://www.my_namespace.org/sensors/1821241365" xlink:href="http://localhost:8080/52nSOSv4.0.0/kvp?request=DescribeSensor&amp;service=SOS&amp;version=2.0.0&amp;procedure=http://www.example.org/sensors/101&amp;procedureDescriptionFormat=http%3A%2F%2Fwww.opengis.net%2FsensorML%2F1.0.1" />
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:capabilities name="featureOfInterest">
                                          <swe:SimpleDataRecord>
                                             <swe:field name="FeatureOfInterestID">
                                                <swe:Text definition="FeatureOfInterest identifier">
                                                   <swe:value>test_feature_6</swe:value>
                                                </swe:Text>
                                             </swe:field>
                                          </swe:SimpleDataRecord>
                                       </sml:capabilities>
                                       <sml:position name="sensorPosition">
                                          <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                             <swe:location>
                                                <swe:Vector gml:id="STATION_LOCATION">
                                                   <swe:coordinate name="easting">
                                                      <swe:Quantity axisID="x">
                                                         <swe:uom code="degree" />
                                                         <swe:value>121.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="northing">
                                                      <swe:Quantity axisID="y">
                                                         <swe:uom code="degree" />
                                                         <swe:value>24.5</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                   <swe:coordinate name="altitude">
                                                      <swe:Quantity axisID="z">
                                                         <swe:uom code="m" />
                                                         <swe:value>50.0</swe:value>
                                                      </swe:Quantity>
                                                   </swe:coordinate>
                                                </swe:Vector>
                                             </swe:location>
                                          </swe:Position>
                                       </sml:position>
                                       <sml:inputs>
                                          <sml:InputList>
                                             <sml:input name="test_observable_property_6">
                                                <swe:ObservableProperty definition="test_observable_property_6" />
                                             </sml:input>
                                          </sml:InputList>
                                       </sml:inputs>
                                       <sml:outputs>
                                          <sml:OutputList>
                                             <sml:output name="test_observable_property_6">
                                                <swe:Quantity definition="test_observable_property_6">
                                                   <swe:uom code="NOT_DEFINED" />
                                                </swe:Quantity>
                                             </sml:output>
                                          </sml:OutputList>
                                       </sml:outputs>
                                       <sml:components>
                                          <sml:ComponentList>
                                             <sml:component name="component1" xlink:title="http://www.example.org/sensors/106#c1" xlink:role="childProcedure">
                                                <sml:System>
                                                   <!-- optional; generated if not present -->
                                                   <sml:identification>
                                                      <sml:IdentifierList>
                                                         <sml:identifier name="uniqueID">
                                                            <sml:Term definition="urn:ogc:def:identifier:OGC:uniqueID">
                                                               <sml:value>http://www.example.org/sensors/106#c1</sml:value>
                                                            </sml:Term>
                                                         </sml:identifier>
                                                      </sml:IdentifierList>
                                                   </sml:identification>
                                                   <sml:position name="sensorPosition">
                                                      <swe:Position referenceFrame="urn:ogc:def:crs:EPSG::4326">
                                                         <swe:location>
                                                            <swe:Vector gml:id="STATION_LOCATION_2">
                                                               <swe:coordinate name="easting">
                                                                  <swe:Quantity axisID="x">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>121.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="northing">
                                                                  <swe:Quantity axisID="y">
                                                                     <swe:uom code="degree" />
                                                                     <swe:value>24.5</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                               <swe:coordinate name="altitude">
                                                                  <swe:Quantity axisID="z">
                                                                     <swe:uom code="m" />
                                                                     <swe:value>50</swe:value>
                                                                  </swe:Quantity>
                                                               </swe:coordinate>
                                                            </swe:Vector>
                                                         </swe:location>
                                                      </swe:Position>
                                                   </sml:position>
                                                   <sml:inputs>
                                                      <sml:InputList>
                                                         <sml:input name="test_observable_property_6">
                                                            <swe:ObservableProperty definition="test_observable_property_6" />
                                                         </sml:input>
                                                      </sml:InputList>
                                                   </sml:inputs>
                                                   <sml:outputs>
                                                      <sml:OutputList>
                                                         <sml:output name="test_observable_property_6">
                                                            <swe:Quantity definition="test_observable_property_6">
                                                               <swe:uom code="NOT_DEFINED" />
                                                            </swe:Quantity>
                                                         </sml:output>
                                                      </sml:OutputList>
                                                   </sml:outputs>
                                                </sml:System>
                                             </sml:component>
                                          </sml:ComponentList>
                                       </sml:components>
                                    </sml:System>
                                 </sml:member>
                              </sml:SensorML>
                           </swes:procedureDescription>
                           <swes:observableProperty>
                              <xsl:value-of select="$observableProperty" />
                           </swes:observableProperty>
                           <swes:metadata>
                              <sos:SosInsertionMetadata>
                                 <sos:observationType>
                                    <xsl:value-of select="$observationType" />
                                 </sos:observationType>
                                 <sos:featureOfInterestType>
                                    <xsl:value-of select="$featureOfInterestType" />
                                 </sos:featureOfInterestType>
                              </sos:SosInsertionMetadata>
                           </swes:metadata>
                        </swes:InsertSensor>
                     </ctl:body>
                     <parsers:XMLValidatingParser>
                        <parsers:schemas>
                           <parsers:schema type="resource">xsd/w3c/xml.xsd</parsers:schema>
                           <parsers:schema>
                              <xsl:attribute name="type">
                                 <xsl:value-of select="$InsertSensorResponseSchemaType" />
                              </xsl:attribute>
                              <xsl:value-of select="$InsertSensorResponseSchemaLocation" />
                           </parsers:schema>
                        </parsers:schemas>
                     </parsers:XMLValidatingParser>
                  </ctl:request>
               </xsl:otherwise>
            </xsl:choose>
         </xsl:variable>
         <xsl:choose>
            <xsl:when test="not($InsertSensorResponse/*)">
               <ctl:message>FAILURE:  The server did not return a response, or the response was not valid according to the InsertSensor response schema for "SOS" /&gt;.</ctl:message>
               <ctl:fail />
            </xsl:when>
            <xsl:otherwise>
               <!-- check the gml:identifier value is same to observation value in the request. -->
               <xsl:if test="$InsertSensorResponse/*">
                  <!-- check the root is "sos:InsertSensorResponse" and empty context.-->
                  <xsl:variable name="responseRoot" select="local-name-from-QName(node-name($InsertSensorResponse/*[1]))" />
                  <xsl:variable name="assignedProcedureCount " select="count($InsertSensorResponse//swes:InsertSensorResponse//swes:assignedProcedure)" />
                  <xsl:variable name="assignedOfferingCount " select="count($InsertSensorResponse//swes:assignedOffering//swes:assignedOffering)" />
                  <xsl:choose>
                     <xsl:when test="not($responseRoot=$InsertSensorRootElementName)">
                        <ctl:message>
                           FAILURE:  The root element from the response to a InsertSensor request "
                           <xsl:value-of select="$responseRoot" />
                           " does not match the expected root element of "
                           <xsl:value-of select="$InsertSensorRootElementName" />
                           "
                        </ctl:message>
                        <ctl:fail />
                     </xsl:when>
                     <xsl:when test="not($assignedProcedureCount=1)">
                        <ctl:message>FAILURE: The count of swes:assignedProcedure element in response must be one and only one.</ctl:message>
                        <ctl:fail />
                     </xsl:when>
                     <xsl:when test="not($assignedOfferingCount=1)">
                        <ctl:message>FAILURE: The count of swes:assignedOffering element in response must be one and only one.</ctl:message>
                        <ctl:fail />
                     </xsl:when>
                     <xsl:otherwise>
                        <ctl:message>Passed.</ctl:message>
                     </xsl:otherwise>
                  </xsl:choose>
               </xsl:if>
            </xsl:otherwise>
         </xsl:choose>
      </ctl:code>
   </ctl:test>
</ctl:package>